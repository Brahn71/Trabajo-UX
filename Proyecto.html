<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Login y Gestión</title>
  <!-- Importar Google Fonts: Poppins para títulos, Questrial para párrafos y Lato para subtítulos -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&family=Questrial&family=Lato:wght@400;700&display=swap" rel="stylesheet">
  <style>
    /* --------------------- RESET Y ESTILOS BÁSICOS --------------------- */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      background-color: #D9E1E8; /* Gris Claro */
      min-height: 100vh;
      font-family: 'Questrial', Arial, sans-serif;
    }

    h1, h2, h3, h4, h5, h6 {
      font-family: 'Poppins', sans-serif;
    }

    label, .subtitle {
      font-family: 'Lato', sans-serif;
    }

    button {
      cursor: pointer;
      border: none;
      font-family: inherit;
    }

    a {
      text-decoration: none;
      color: #27374D;
      font-weight: bold;
    }

    a:hover {
      text-decoration: underline;
    }

    /* --------------------- HEADER FIJO (Layout y Logo) --------------------- */
    #main-header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background-color: #27374D; /* Azul Oscuro */
      padding: 10px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      z-index: 1000;
    }

    #main-header .header-content {
      display: flex;
      align-items: center;
    }

    /* Se utiliza una imagen placeholder que simula el logo en negro y naranja.
       Aunque la imagen fuente es de 300x300 px para cumplir con los requerimientos,
       se redimensiona para adaptarse al header. */
    #main-header img {
      width: 60px;
      height: auto;
    }

    #main-header nav ul {
      list-style: none;
      display: flex;
      margin-left: 20px;
    }

    #main-header nav ul li {
      margin-right: 15px;
    }

    /* Íconos de navegación: se emplean Unicode para ejemplificar, con tamaño aproximado */
    #main-header nav ul li a {
      color: #FFFFFF;
      font-size: 24px;
    }

    /* --------------------- CONTENEDORES DE LOGIN/REGISTRO --------------------- */
    .container {
      background: #FFFFFF;
      padding: 60px;
      box-shadow: 0px 4px 10px rgba(39,55,77,0.2);
      border-radius: 8px;
      text-align: center;
      width: 320px;
      margin: 120px auto 20px; /* Se ajusta el margen superior para dejar espacio al header fijo */
    }

    .container h2 {
      margin-bottom: 10px;
    }

    .container input {
      display: block;
      width: 100%;
      margin: 10px 0;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }

    .container button {
      background: #27374D;
      color: #FFFFFF;
      padding: 10px;
      width: 100%;
      border-radius: 5px;
      transition: background 0.3s ease;
    }

    .container button:hover {
      background: #1B2535;
    }

    /* --------------------- SECCIÓN PRINCIPAL DE INVENTARIO --------------------- */
    #inventory-container {
      display: none;
      padding: 20px;
      margin-top: 60px; /* Espacio para el header fijo */
    }

    /* Cabecera interna (opcional) */
    #inventory-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    #user-info {
      display: flex;
      align-items: center;
    }

    #user-avatar {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      margin-right: 10px;
      object-fit: cover;
    }

    /* Botones Agregar y Filtro */
    #inventory-actions {
      margin-bottom: 20px;
    }

    #inventory-actions button {
      margin-right: 10px;
      padding: 10px 20px;
      background: #27374D;
      color: #FFFFFF;
      border-radius: 5px;
      transition: background 0.3s ease;
    }

    #inventory-actions button:hover {
      background: #1B2535;
    }

    /* --------------------- TABLA DE INVENTARIO --------------------- */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }

    table thead {
      background-color: #27374D;
      color: #FFFFFF;
    }

    table th, table td {
      padding: 10px;
      text-align: left;
      border-bottom: 1px solid #ccc;
    }

    table tbody tr:hover {
      background-color: #f4f4f4;
    }

    .btn-gestionar {
      background: #526D82; /* Azul Medio */
      color: #FFFFFF;
      padding: 6px 12px;
      border-radius: 5px;
      transition: background 0.3s ease;
      border: none;
    }

    .btn-gestionar:hover {
      background: #42576b;
    }

    /* --------------------- MODALES (Pop-ups con bordes en Azul Oscuro Extra) --------------------- */
    .modal {
      display: none;
      position: fixed;
      z-index: 999;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0, 0, 0, 0.5);
    }

    .modal-content {
      background-color: #FFFFFF;
      margin: 5% auto;
      padding: 20px;
      border: 2px solid #1B2535;
      width: 400px;
      border-radius: 8px;
      position: relative;
    }

    .modal-content h2 {
      margin-bottom: 15px;
    }

    .modal-content label {
      display: block;
      margin-top: 10px;
      margin-bottom: 5px;
      font-weight: bold;
    }

    .modal-content input[type="text"],
    .modal-content input[type="date"],
    .modal-content select,
    .modal-content textarea {
      width: 100%;
      padding: 10px;
      margin-bottom: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }

    .modal-content textarea {
      resize: vertical;
    }

    .modal-content button {
      margin-right: 5px;
      padding: 8px 12px;
      border-radius: 5px;
      transition: background 0.3s ease;
      font-family: inherit;
      color: #FFFFFF;
      border: none;
    }

    .modal-content button.save {
      background-color: #27374D;
    }

    .modal-content button.edit {
      background-color: #526D82;
    }

    .modal-content button.delete {
      background-color: #27374D;
    }

    .modal-content button.cancel {
      background-color: #526D82;
    }

    .modal-content button:hover {
      opacity: 0.9;
    }
  </style>
</head>
<body>

  <!-- HEADER FIJO CON LOGO E ICONOGRAFÍA -->
  <header id="main-header">
    <div class="header-content">
      <img src="imag/WhatsApp Image 2025-02-21 at 9.27.29 PM.jpeg" alt="Logo">
      <nav>
        <ul>
          <li><a href="#" title="Inicio">⌂</a></li>
          <li><a href="#" title="Ajustes">☼</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- --------------------- CONTENEDOR DE LOGIN --------------------- -->
  <div class="container" id="login-container">
    <h2>Login</h2>
    <p>Inicia sesión para continuar</p>
    <input type="email" id="login-email" placeholder="Correo">
    <input type="password" id="login-password" placeholder="Contraseña">
    <button onclick="login()">Login</button>
    <p>¿No tienes cuenta? <a href="#" onclick="showRegister()">Regístrate</a></p>
  </div>

  <!-- --------------------- CONTENEDOR DE REGISTRO --------------------- -->
  <div class="container" id="register-container" style="display: none;">
    <h2>Registrar</h2>
    <p>¿Ya estás registrado? <a href="#" onclick="showLogin()">Acceso</a></p>
    <input type="text" id="register-name" placeholder="Nombre">
    <input type="email" id="register-email" placeholder="Correo">
    <input type="password" id="register-password" placeholder="Contraseña">
    <input type="password" id="confirm-password" placeholder="Confirmar contraseña">
    <button onclick="register()">Sign Up</button>
  </div>

  <!-- --------------------- CONTENEDOR PRINCIPAL DE INVENTARIO --------------------- -->
  <div id="inventory-container">
    <!-- Cabecera interna (opcional) -->
    <div id="inventory-header">
      <div id="user-info">
        <img src="https://img.freepik.com/vector-gratis/circulo-azul-usuario-blanco_78370-4707.jpg" alt="User Avatar" id="user-avatar">
        <span id="user-name" style="font-weight: bold;"></span>
      </div>
    </div>

    <!-- Botones de acción (Agregar, Filtro) -->
    <div id="inventory-actions">
      <button onclick="showAddModal()">Agregar</button>
      <button onclick="showFilterModal()">Filtro</button>
    </div>

    <!-- Tabla de Inventario -->
    <table id="inventory-table">
      <thead>
        <tr>
          <th>Nombre</th>
          <th>Estado</th>
          <th>Descripción</th>
          <th>Tipo</th>
          <th>Modelo</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <!-- Se llena dinámicamente con JS -->
      </tbody>
    </table>
  </div>

  <!-- --------------------- MODAL: AGREGAR --------------------- -->
  <div id="add-modal" class="modal">
    <div class="modal-content">
      <h2>Agregar</h2>
      <label for="add-nombre">Nombre</label>
      <input type="text" id="add-nombre">

      <label for="add-estado">Estado</label>
      <select id="add-estado">
        <option value="Nuevo">Nuevo</option>
        <option value="Usado">Usado</option>
        <option value="Dañado">Dañado</option>
      </select>

      <label for="add-fecha">Fecha entrada</label>
      <input type="date" id="add-fecha">

      <label for="add-localizacion">Localización</label>
      <input type="text" id="add-localizacion">

      <label for="add-tipo">Tipo</label>
      <input type="text" id="add-tipo">

      <label for="add-modelo">Modelo</label>
      <input type="text" id="add-modelo">

      <label for="add-descripcion">Descripción Producto</label>
      <textarea id="add-descripcion"></textarea>

      <button class="save" onclick="saveItem()">Guardar</button>
      <button class="cancel" onclick="closeAddModal()">Cancelar</button>
    </div>
  </div>

  <!-- --------------------- MODAL: GESTIONAR --------------------- -->
  <div id="manage-modal" class="modal">
    <div class="modal-content">
      <h2>Gestionar</h2>

      <label for="manage-nombre">Nombre</label>
      <input type="text" id="manage-nombre">

      <label for="manage-tipo">Tipo</label>
      <input type="text" id="manage-tipo">

      <label for="manage-estante">Estante</label>
      <input type="text" id="manage-estante">

      <label for="manage-estado">Estado</label>
      <select id="manage-estado">
        <option value="Nuevo">Nuevo</option>
        <option value="Usado">Usado</option>
        <option value="Dañado">Dañado</option>
      </select>

      <label for="manage-descripcion">Descripción</label>
      <textarea id="manage-descripcion"></textarea>

      <label for="manage-localizacion">Localización</label>
      <input type="text" id="manage-localizacion">

      <label for="manage-prestar">Prestar a</label>
      <input type="text" id="manage-prestar">

      <label for="manage-carta">Carta Resguardo</label>
      <input type="text" id="manage-carta">

      <label for="manage-fecha">Fecha entrada</label>
      <input type="date" id="manage-fecha">

      <!-- Botones -->
      <button class="edit" onclick="editItem()">Editar</button>
      <button class="delete" onclick="deleteItem()">Eliminar</button>
      <button class="cancel" onclick="closeManageModal()">Cancelar</button>
      <button class="save" onclick="saveManageChanges()">Guardar</button>
    </div>
  </div>

  <!-- --------------------- MODAL: FILTRO --------------------- -->
  <div id="filter-modal" class="modal">
    <div class="modal-content">
      <h2>Filtrar</h2>
      <label for="filter-nombre">Nombre</label>
      <input type="text" id="filter-nombre">

      <button class="save" onclick="applyFilter()">Aplicar Filtro</button>
      <button class="cancel" onclick="closeFilterModal()">Cerrar</button>
    </div>
  </div>

  <!-- --------------------- SCRIPT PRINCIPAL --------------------- -->
  <script>
    /****************** USUARIOS ******************/
    let users = [];           // Almacena usuarios registrados
    let currentUser = null;   // Usuario logueado

    /****************** DATOS DE INVENTARIO ******************/
    let items = [];           // Array donde guardaremos los ítems
    let currentItemIndex = -1; // Índice del ítem en edición

    /* ---------- MOSTRAR/OCULTAR SECCIONES DE LOGIN/REGISTRO ---------- */
    function showRegister() {
      document.getElementById('login-container').style.display = 'none';
      document.getElementById('register-container').style.display = 'block';
    }

    function showLogin() {
      document.getElementById('register-container').style.display = 'none';
      document.getElementById('login-container').style.display = 'block';
    }

    /* ---------- REGISTRAR USUARIO ---------- */
    function register() {
      let name = document.getElementById('register-name').value;
      let email = document.getElementById('register-email').value;
      let password = document.getElementById('register-password').value;
      let confirmPassword = document.getElementById('confirm-password').value;

      if (!name || !email || !password || !confirmPassword) {
        alert("Todos los campos son obligatorios");
        return;
      }

      if (password !== confirmPassword) {
        alert("Las contraseñas no coinciden");
        return;
      }

      // Verificar si el usuario ya existe
      let exists = users.some(u => u.email === email);
      if (exists) {
        alert("Ya existe un usuario con este correo");
        return;
      }

      // Registrar nuevo usuario
      users.push({ name, email, password });
      alert("Usuario registrado con éxito");
      showLogin();
    }

    /* ---------- LOGIN ---------- */
    function login() {
      let email = document.getElementById('login-email').value;
      let password = document.getElementById('login-password').value;

      let user = users.find(u => u.email === email && u.password === password);
      if (user) {
        alert("Login exitoso");
        currentUser = user;
        document.getElementById('login-container').style.display = 'none';
        document.getElementById('register-container').style.display = 'none';
        document.getElementById('inventory-container').style.display = 'block';
        document.getElementById('user-name').innerText = user.name;
      } else {
        alert("Usuario o contraseña incorrectos");
      }
    }

    /****************** FUNCIONES PARA EL INVENTARIO ******************/

    function refreshTable(filteredItems = null) {
      let tbody = document.querySelector('#inventory-table tbody');
      tbody.innerHTML = '';

      let dataToRender = filteredItems || items;

      dataToRender.forEach((item, index) => {
        let row = document.createElement('tr');

        let tdNombre = document.createElement('td');
        tdNombre.textContent = item.nombre;

        let tdEstado = document.createElement('td');
        tdEstado.textContent = item.estado;

        let tdDesc = document.createElement('td');
        tdDesc.textContent = item.descripcion;

        let tdTipo = document.createElement('td');
        tdTipo.textContent = item.tipo;

        let tdModelo = document.createElement('td');
        tdModelo.textContent = item.modelo;

        let tdGestionar = document.createElement('td');
        let btnGestionar = document.createElement('button');
        btnGestionar.textContent = 'Gestionar';
        btnGestionar.className = 'btn-gestionar';
        btnGestionar.onclick = () => showManageModal(index);
        tdGestionar.appendChild(btnGestionar);

        row.appendChild(tdNombre);
        row.appendChild(tdEstado);
        row.appendChild(tdDesc);
        row.appendChild(tdTipo);
        row.appendChild(tdModelo);
        row.appendChild(tdGestionar);

        tbody.appendChild(row);
      });
    }

    function showAddModal() {
      document.getElementById('add-modal').style.display = 'block';
    }

    function closeAddModal() {
      document.getElementById('add-modal').style.display = 'none';
      document.getElementById('add-nombre').value = '';
      document.getElementById('add-estado').value = 'Nuevo';
      document.getElementById('add-fecha').value = '';
      document.getElementById('add-localizacion').value = '';
      document.getElementById('add-tipo').value = '';
      document.getElementById('add-modelo').value = '';
      document.getElementById('add-descripcion').value = '';
    }

    function saveItem() {
      let nombre = document.getElementById('add-nombre').value;
      let estado = document.getElementById('add-estado').value;
      let fecha = document.getElementById('add-fecha').value;
      let localizacion = document.getElementById('add-localizacion').value;
      let tipo = document.getElementById('add-tipo').value;
      let modelo = document.getElementById('add-modelo').value;
      let descripcion = document.getElementById('add-descripcion').value;

      items.push({
        nombre,
        estado,
        fechaEntrada: fecha,
        localizacion,
        tipo,
        modelo,
        descripcion,
        estante: '',
        prestarA: '',
        cartaResguardo: ''
      });

      refreshTable();
      closeAddModal();
    }

    function showManageModal(index) {
      currentItemIndex = index;
      let item = items[index];

      document.getElementById('manage-nombre').value = item.nombre;
      document.getElementById('manage-tipo').value = item.tipo;
      document.getElementById('manage-estante').value = item.estante || '';
      document.getElementById('manage-estado').value = item.estado;
      document.getElementById('manage-descripcion').value = item.descripcion;
      document.getElementById('manage-localizacion').value = item.localizacion;
      document.getElementById('manage-prestar').value = item.prestarA || '';
      document.getElementById('manage-carta').value = item.cartaResguardo || '';
      document.getElementById('manage-fecha').value = item.fechaEntrada || '';

      document.getElementById('manage-modal').style.display = 'block';
    }

    function closeManageModal() {
      document.getElementById('manage-modal').style.display = 'none';
    }

    function editItem() {
      alert("Puedes editar los campos y luego presionar 'Guardar' para confirmar.");
    }

    function saveManageChanges() {
      if (currentItemIndex < 0) return;
      let item = items[currentItemIndex];
      item.nombre = document.getElementById('manage-nombre').value;
      item.tipo = document.getElementById('manage-tipo').value;
      item.estante = document.getElementById('manage-estante').value;
      item.estado = document.getElementById('manage-estado').value;
      item.descripcion = document.getElementById('manage-descripcion').value;
      item.localizacion = document.getElementById('manage-localizacion').value;
      item.prestarA = document.getElementById('manage-prestar').value;
      item.cartaResguardo = document.getElementById('manage-carta').value;
      item.fechaEntrada = document.getElementById('manage-fecha').value;

      refreshTable();
      closeManageModal();
    }

    function deleteItem() {
      if (currentItemIndex < 0) return;
      if (confirm("¿Seguro que deseas eliminar este ítem?")) {
        items.splice(currentItemIndex, 1);
        refreshTable();
        closeManageModal();
      }
    }

    function showFilterModal() {
      document.getElementById('filter-modal').style.display = 'block';
    }

    function closeFilterModal() {
      document.getElementById('filter-modal').style.display = 'none';
      document.getElementById('filter-nombre').value = '';
      refreshTable();
    }

    function applyFilter() {
      let filterName = document.getElementById('filter-nombre').value.toLowerCase().trim();
      if (filterName === '') {
        alert("Ingresa un nombre para filtrar");
        return;
      }
      let filtered = items.filter(item => 
        item.nombre.toLowerCase().includes(filterName)
      );
      refreshTable(filtered);
      closeFilterModal();
    }
  </script>
</body>
</html>
